<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aeio Dev Agent - Workspace</title>
    <link rel="icon" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div id="app">
        <header class="header">
            <button id="mobileMenuBtn" class="mobile-menu-btn btn-icon" aria-label="打开菜单" title="打开菜单">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="3" y1="12" x2="21" y2="12"></line>
                    <line x1="3" y1="6" x2="21" y2="6"></line>
                    <line x1="3" y1="18" x2="21" y2="18"></line>
                </svg>
            </button>
            <a href="/" class="header-logo">
                <h1>Aeio Dev Agent</h1>
            </a>
            <div class="header-actions">
                <span id="userInfo"></span>
                <button id="logoutBtn" class="btn btn-secondary">登出</button>
            </div>
        </header>

        <main class="main-container">
            <!-- Session Sidebar -->
            <aside id="sessionSidebar" class="session-sidebar">
                <div class="session-sidebar-header">
                    <button id="hideSessionsBtn" class="btn-icon" aria-label="隐藏项目列表" title="隐藏项目列表">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                    </button>
                    <h2>项目列表</h2>
                    <button id="newSessionBtn" class="btn-icon" title="新建项目" aria-label="新建项目">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                </div>
                <div id="sessionsList" class="sessions-list">
                    <!-- Sessions will be loaded here -->
                </div>
            </aside>

            <!-- Main Chat Area -->
            <section class="chat-area">
                <div class="chat-header">
                    <button id="showSessionsBtn" class="btn-icon" aria-label="显示项目列表" title="显示项目列表">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="9" y1="3" x2="9" y2="21"></line>
                        </svg>
                    </button>
                    <span id="currentSessionTitle" class="current-session-title">选择一个项目</span>
                    <button id="newSessionInlineBtn" class="btn-icon" aria-label="新建项目" title="新建项目">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                    </button>
                </div>
                <div id="readOnlyBanner" class="read-only-banner" style="display: none;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                        <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                    </svg>
                    <span>这是公开分享的会话，您只能查看不能修改</span>
                </div>

                <div class="messages-section">
                    <div id="messagesContainer" class="messages-container">
                        <p class="empty-state">选择或创建一个项目开始开发</p>
                    </div>

                    <!-- Todos Panel -->
                    <div id="todosPanel" class="todos-panel" style="display: none;">
                        <div class="todos-header">
                            <span class="todos-title">任务列表</span>
                            <span class="todos-count"></span>
                        </div>
                        <div class="todos-list"></div>
                    </div>

                    <form id="messageForm" class="message-form">
                        <div class="textarea-container">
                            <textarea
                                id="messageInput"
                                placeholder="描述你的需求或修改建议..."
                                disabled
                                rows="3"
                            ></textarea>
                            <button type="submit" class="send-icon-btn" aria-label="发送消息">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <line x1="22" y1="2" x2="11" y2="13"></line>
                                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                                </svg>
                            </button>
                        </div>
                    </form>
                </div>
            </section>

            <!-- Right: Preview Area (70%) -->
            <section class="preview-area">
                <div class="preview-header">
                    <h2>预览</h2>
                    <div class="preview-actions">
                        <button id="experienceBtn" class="btn btn-secondary btn-small btn-icon-text" style="display: none;" title="在新窗口打开">
                            <span>体验</span>
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                                <polyline points="15 3 21 3 21 9"></polyline>
                                <line x1="10" y1="14" x2="21" y2="3"></line>
                            </svg>
                        </button>
                        <button id="shareBtn" class="btn btn-secondary btn-small btn-icon-text" style="display: none;" title="复制链接">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <circle cx="18" cy="5" r="3"></circle>
                                <circle cx="6" cy="12" r="3"></circle>
                                <circle cx="18" cy="19" r="3"></circle>
                                <line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line>
                                <line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line>
                            </svg>
                            <span>分享</span>
                        </button>
                        <button id="setPublicBtn" class="btn btn-primary btn-small btn-icon-text" style="display: none;" title="设置为公开分享">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                            <span>公开</span>
                        </button>
                        <button id="refreshPreviewBtn" class="btn btn-secondary btn-small btn-icon-text" title="刷新预览">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <polyline points="23 4 23 10 17 10"></polyline>
                                <polyline points="1 20 1 14 7 14"></polyline>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                            <span>刷新</span>
                        </button>
                    </div>
                </div>
                <div class="preview-container">
                    <iframe id="previewFrame" class="preview-frame"></iframe>
                </div>
            </section>

            <!-- Mobile Tab Navigation -->
            <nav class="mobile-tabs" id="mobileTabs">
                <button class="mobile-tab active" data-view="chat">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg>
                    <span>对话</span>
                </button>
                <button class="mobile-tab" data-view="preview">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <span>预览</span>
                </button>
            </nav>
        </main>
    </div>

    <script src="/static/js/api.js"></script>
    <script src="/static/js/auth.js"></script>
    <script src="/static/js/progress.js"></script>
    <script src="/static/js/sse-client.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
